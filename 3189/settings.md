# Первоначальная настройка компонентов ПО Carrot

## Настройка Carrot Server

### Общая информация

**Carrot Server** - единое место хранения медиа-контента и баз данных, представляет из себя связующее звяно между приложениями Carrot.

Интерфейс состоит из трёх полей:
- лента меню;
- поле компонентов;
- поле статуса.

Лента меню включает в себя 3 раздела:
- `File` - настройки приложения.
- `Tools` - инструменты приложения.
- `Help` - информация о текущей сборке.

---

### Settings

Для настройки **Carrot Server** необходимо выполнить следующее:

1. Запустите **Carrot Server**.

2. Откройте окно настроек по пути `File` - `Settings`.

3. Настройки **Carrot Server** имеют 3 раздела: `DataBase`, `Digital Assets`, `WebSocket`.

4. Раздел `DataBase`, включает следующие поля для редактирования:

- `Directory` - директория, в которой хранится база данных **Carrot Server**. *Примечание: данное поле лучше не редактировать.*
- `Replication Hosts` - IP-адреса резервных серверов на которые реплицируется база данных **Carrot Server**. Пример: 192.168.1.1 (единичный сервер), 192.168.1.1,192.168.1.2,192.168.1.3 (множество серверов записываются через запятую).
- `DB autoreplication on start` - автоматическая репликация базы данных **Carrot Server** при запуске приложения.

5. Раздел `Digital Assets`, включает следующие поля для редактирования:
- `Directory` - директория в которой хранятся медиа файлы, экспортируемые вместе с шаблонами, а также задаваемые через **Carrot Playlist**. *Примечание: данное поле лучше не редактировать.*

6. Раздел `WebSocket`, включает следующие поля для редактирования:
- `Certificate` - путь к файлу сертификата **.pfx**, если предполагается использование шифрованного соединения.
- `Certificate Password` - пароль к файлу сертификата **.pfx**.
- `Secure Connection` - установите `True`, если предполагается использование шифрованного соединения.

7. Нажмите кнопку `Save` и закройте окно настроек.

![Settings_Carrot Server_Settings](..\images\3189\image_001.jpg "Carrot Server - Settings")

---

### Tools

Инструменты приложения **Carrot Server** имеют следующие возможности:

- `Change Administrator Password` - смена пароля администратора.
- `Reset Events Status` - обновление поля компонентов для корректного отображения активных приложений.
- `Set Server As Master` - установить текущий сервер Host'ом (Host отображается в поле статуса как `Replication Index = 0`).
- `Replicate DB` - реплицировать базу данных **Carrot Server**.

### Важно!
- При использовании нескольких серверов с реплицируемой базой данных, каждому серверу автоматически присваивается `Replication Index`, где 0 - мастер, 1,2,3... - резерв. Если каждый сервер имеет значение равное 0, значит сервера не подцепились друг к другу.
- При отключении мастера, следующим мастером становится сервер, который быстрее остальных среагировал на процесс.


---
---












## Настройка Web Playlist

Для настройки **Carrot Playlist** необходимо выполнить следующее:

1.  Запустите **Carrot Server** `CarrotServer.exe` (Если **Carrot Server** уже запущен, перейдите на пункт 2).
2.  Чтобы иметь возможность подключаться к **Carrot Web Playlist**, необходимо выполнить сл. первоначальные настройки: 1. Запустите `WebPlaylistSettings.exe`.

            ![](..\images\image158.png)

        2. В параметре Hosts укажите путь порт для подключения. Например, *:8088 - где 8080 указывает на порт подключения.

        3. В параметре Certifiacte укажите путь к сертификату.

        4. В параметре Certifiacte Password укажите пароль к сертификату.

        5. В параметре Server Host укажите IP адрес машины на которой запущен **Carrot Server**.

        6. Запустите `WebPlaylist.exe`, если запуск прошел успешно вы увидите следующее окно:

            ![](..\images\image37.png)

    > Процесс создания самоподписанного сертификата описан в пункте [Создание самоподписаного сертификата](https://carrotsoftware.github.io/docs/#/settings?id=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B8-%D1%8D%D0%BA%D1%81%D0%BF%D0%BE%D1%80%D1%82-%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0-Windows).

3.  Запустите браузер (рекомендуется использовать **Google Chrome**) и в адресной строке введите `http://addr:port/` (где `addr` - IP адрес, либо имя машины, на которой запущен **Carrot Web Playlist**, `port` - порт). Например, `http://192.168.1.23:8088/`. При использовании сертификатов безопасности подключение нужно осуществлять через `https`.

    ![](..\images\image41.png)

4.  Введите `логин` и `пароль`.

---

Окно **Carrot Web Playlist** имеет несколько вкладок со следующими опциями:

![](..\images\image27.png)

- Вкладка `Playlist` - служит для управления заполненными плейлистами.
- Вкладка `Editor` - создание и редактирование плейлистов.
- Вкладка `Browser` - отображает весь медиаконтент, загруженный на сервер (фото, видео, шаблоны UE4, шаблоны AE).

Во вкладке `Playlist` имеются следующие кнопки:

![](..\images\image133.png)

| Название     | Описание                                                                      |
| ------------ | ----------------------------------------------------------------------------- |
| `Load`       | загружает выбранное события в плейлисте.                                      |
| `Load all`   | загружает все события в плейлисте.                                            |
| `In`         | загружает и переводит активирует событие выбранное событие в плейлисте.       |
| `Next`       | деактивирует выделенное событие в плейлисте и активирует нижестоящее событие. |
| `Out`        | деактивирует выделенное событие в плейлисте.                                  |
| `Unload`     | выгружает выбранное события в плейлисте.                                      |
| `Unload all` | выгружает все события в плейлисте.                                            |

Каждое событие в Carrot Playlist имеет может находиться в следующем состоянии:

| Название | Цвет                                        | Описание                                          |
| -------- | ------------------------------------------- | ------------------------------------------------- |
| Unloaded | <span style="color:gray">Серый</span>       | Событие с шаблоном не загружено внутри плейлиста. |
| Loading  | <span style="color:orange">Оранжевый</span> | Событие с шаблоном загружается внутри плейлиста.  |
| Ready    | <span style="color:blue">Голубой</span>     | Событие с шаблоном загружено и готово к работе.   |
| Active   | <span style="color:green">Зеленый</span>    | Событие с шаблоном активировано.                  |

> Процесс наполнения и редактирования событий в плейлисте описан в пункте [Создание плейлиста](https://carrotsoftware.github.io/docs/#/workflow?id=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%bb%d0%b5%d0%b9%d0%bb%d0%b8%d1%81%d1%82%d0%b0).

## Создание и экспорт самоподписанного сертификата Windows

Для создания самоподписанного сертификата для **Carrot Playlist** необходимо выполнить следующее:

1. Запустите **PowerShell** с правами **администратора**.
1. Скопируйте имя компьютера (ПКМ по **Этот компьютер** → **Свойства** → **Имя устройства**).
1. Введите в консоль **PowerShell** (имя компьютера необходимо ввести без кавычек)  
   `$thumbprint=New-SelfSignedCertificate -DnsName "Имя компьютера" -CertStoreLocation cert:\LocalMachine\My |ForEach-Object{ $_.Thumbprint}`
1. Создайте папку для хранения сертификатов прим. `C:\Certificates`.
1. Создайте переменную пути сертификата консольной командой `$certpath = "Путь файла с кавычками прим. C:\Certificates\pc1.pfx"`.
1. Создайте переменную пароля консольной командой `$mypwd = ConvertTo-SecureString -String 123 -Force –AsPlainText` где `123` должен быть ваш пароль.
1. Введите в консоль **PowerShell**  
   `Export-PfxCertificate -FilePath $certpath -Cert cert:\localmachine\My\$thumbprint -Password $mypwd`.
1. Для импорта сертификата на текущем компьютере введите команду `Import-PfxCertificate -FilePath  $certpath -Password $mypwd -CertStoreLocation cert:\LocalMachine\Root`
   > Процесс импорта самоподписанного сертификата на других компьютерах описан в пункте [Импорт самоподписаного сертификата](https://carrotsoftware.github.io/docs/#/settings?id=%D0%98%D0%BC%D0%BF%D0%BE%D1%80%D1%82-%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0).

## Импорт самоподписанного сертификата

Для импорта самоподписанного сертификата для **Carrot Playlist** необходимо выполнить следующее:

1. Запустите **PowerShell** с правами **администратора**.
1. Создайте переменную пути сертификата консольной командой `$certpath = "Путь файла с кавычками прим. C:\Certificates\pc1.pfx"`.
1. Создайте переменную пароля консольной командой `$mypwd = ConvertTo-SecureString -String 123 -Force –AsPlainText` где `123` должен быть ваш пароль.
1. Импортируйте сертификат командой `Import-PfxCertificate -FilePath $certpath -Password $mypwd -CertStoreLocation cert:\LocalMachine\Root`

## Настройка Carrot RTC Server

Для настройки **Carrot RTC Server** необходимо выполнить следующее:

1. Запустите **Carrot Server** `ServerWS.exe` (Если **Carrot Server** уже запущен, перейдите на пункт 2).
2. Запустите **Carrot RTC Server** `CarrotRTCWS.exe`.

> Если **Carrot Server** не был запущен, либо **Carrot RTC Server** не смог установить с ним соединение, то на рабочем столе появится окно с ошибкой:
> <br/>![](..\images\image13.png)

При нажатии на кнопку `Отмена` **Carrot RTC Server** завершит работу.

При нажатии на кнопку `Повтор` на рабочем столе откроется следующее окно `Settings` с настройками соединения **Carrot RTC Server**:

![](..\images\image91.png)

- Вкладка DeckLink
  - `Input Device` - Устройство ввода.
  - `Output Device` - Устройство вывода.
  - `Mode` - Формат изображения.
  - `Enabled` - Использовать устройство ввода/вывода.
- Вкладка Network
  - `Server Host` - Имя или IP адрес хоста сервера.
  - `Secure Connection` - Режим защищенного подключения.
- Вкладка Processing
  - `Video threads count` - Количество видеопотоков для обработки логическими процессорами.
  - `Dedicated Processing` - Обработка видеопотоков логическими процессорами.
- Вкладка Render
  - `Render Width` - Ширина рендера изображения для клиента.
  - `Render Height` - Высота рендера изображения для клиента.
  - `Pixel Aspect Ratio` - Соотношение сторон пикселя.
  - `VSync` - Вертикальная синхронизация.
- Вкладка RTC
  - `Audio Enabled` - Включение звука.
  - `Preview Audio` - не используется.
  - `Raw Data Sender Port` - Порт для отправки изображения клиенту.
  - `Raw Data Receivers` - IP адрес по которому приходят данные.
  - `Send Raw Data` -
  - `Client Limit` - Лимит подключений.
  - `Reply Enabled` - Отправлять сигнал клиенту.
  - `Reply Width` - Предпочитаемая ширина кадра от клиента.
  - `Reply Height` - Предпочитаемая высота кадра от клиента.
  - `Reply FPS` - Предпочитаемая частота кадров в секунду от клиента.
  - `Reply DataMap Name` - Имя файла для обмена кадрами между процессом и формой RTC сервера.
  - `WebSocket Port` - Порт для подключения клиента по протоколу WebSocket.
  - `Certificate` - Путь к директории с сертификатом.
  - `Certificate Password` - Пароль сертификата.
- Вкладка User
  - `Auto Logon` - Автоматическая авторизация.
  - `User Name` - Имя пользователя.
  - `Password` - Пароль.

После ввода всех необходимых настроек нажмите кнопку `Save` в верхнем правом углу окна и закройте окно `Settings`. **Carrot RTC Server** произведет попытку подключения.

При успешном подключении к серверу на рабочем столе появится окно **Carrot RTC Server**:

![](..\images\image3.png)

Окно **Carrot RTC Server** имеет несколько вкладок со следующими опциями:

- Меню `File`

  ![](..\images\image144.png)

  - `Outputs` - Настройка вывода изображения.
  - `Settings` - Открывает окно настройки **Carrot RTC Server** (вид и описание окна с его настройками изложены выше).
  - `Exit` (Комбинация клавиш <kbd>Alt + F4</kbd>) - выход из **Carrot RTC Server**.

- Меню `Tools`

  ![](..\images\image40.png)

  - `RTC Procs` - Открывает окно RTC процессов.

    ![](..\images\image175.png)

    > Окно **Web RTC Processes** имеет следующий функционал:
    >
    > - Запуск и остановка соединений.
    > - Вывод формы соединения.
    > - Вывод системных сообщений соединения.

  - `Copy login data` (Комбинация клавиш <kbd>Ctrl + L</kbd>) - Копирует в буфер обмена ссылку для авторизации на сервере с выбранным логином и паролем.
  - `Reset` (Комбинация клавиш <kbd>Ctrl + R</kbd>) - Сброс.

- Меню `Help`

  ![](..\images\image36.png)

  - `About` - информация о версии **ПО Carrot**.

Внутри окна **Carrot RTC Server** расположены следующие блоки:

- Блок `Streams` - Необходим для создания, редактирования и удаления подключений.

  - `Add` - добавляет новое подключение. После нажатия пользователю предлагается ввести название для подключения и подтвердить ввод.

  ![](..\images\image11.png)

  - `Delete` - удаляет выбранное подключение.

- Блок `Groups` - Необходим для создания, редактирования и удаления групп подключений.

  - `Add` - добавляет новую группу. После нажатия пользователю предлагается ввести название для группы и подтвердить ввод.

  ![](..\images\image11.png)

  - `Delete` - удаляет выбранную группу.

- Блок `Viewport` - необходим для предпросмотра всех добавленных подключений.
  - Меню `Options`:
    - `Full screen` (клавиша <kbd>F2</kbd>) - перевод блока в полноэкранный режим.
  - Меню `Tools`:
    - `Export Frame` - создание и экспорт скриншота блока `Viewport`.
- Блок `Audio`:
  - `Recording Device` - устройство ввода звука.
  - `Playout Device` - устройство вывода звука.
- Блок `Video`:
  - `Select template…` - выбор шаблона.
- Блок `Properties` - содержит в себе свойства выбранного элемента в блоках `Streams` и `Groups`.
  - `Name` - название подключения.
  - `Login` - логин для авторизации на RTC сервере.
  - `Password` - пароль для авторизации на RTC сервере.
  - `New` - сгенерировать новый пароль.
  - `Alias` - псевдоним.
  - `Group` - выбор группы, к которой относится подключение.
  - `Comment` - комментарий.
  - `Server 1` - адрес RTC сервера с портом подключения.
  - `Server 2` - резервный адрес RTC сервера с портом подключения.
  - `Width` - предпочитаемая ширина кадра.
  - `Height` - предпочитаемая высота кадра.
  - `Rec. Host` - адрес и порт получателя изображения.
  - `Screen` - выбор подключения, который является изображением с экрана того же клиента.
  - `Is Screen` - является ли это подключение изображением с экрана.
  - `Kbps(Min)` - минимальный битрейт обратного сигнала клиенту.
  - `Kbps(Max)` - максимальный битрейт обратного сигнала клиенту.
  - `Codec` - кодек для обработки видеоизображения.
  - `FPS` - предпочитаемое количество кадров в секунду.
  - `GOP size` - частота опорных кадров.
  - `Update` - применить изменения для подключения.

Внизу окна **Carrot RTC Server** находится строка статистики:

![](..\images\image113.png)

- `FPS` - количество кадров в секунду (время отрисовки кадра в миллисекундах)
- `Physical memory usage` - использование оперативной памяти в мегабайтах.
- `Render Thread CPU usage` - процент загрузки логического процессора.
- `Total GPU Memory Usage` - использование видеопамяти.
- `Output Delay` - задержка на выходе.

## Настройка Carrot Keyer

Чтобы открыть панель настроек **Carrot Keyer**:
<br/>В **Carrot Engine**, `Tools` > `Show Content Settings`

![](..\images\image12.png)

Откроется новое окно с панелью настроек **Carrot Keyer**:

![](..\images\image14.jpg)

### Выпадающее меню `Mode`:

![](..\images\image130.png)

Меню `Mode` используется для переключения режимов отображения в **Carrot Keyer**:

Режим `MultiView` выводит на экран большинство опций.

### Вкладка `Key`

![](..\images\image14.jpg)

#### `DeNoise` - функция сглаживания шумов.

![](..\images\image165.png)

- `Threshold` - порог обработки.
- `Radius` - радиус обработки.

#### `DeSpill` - функция обработки паразитных рефлексов

![](..\images\image118.png)

- `Presets` - готовые пресеты.
- `Red Weight` - Вес красного цвета.
- `Blue Weight` - Вес синего цвета.
- `Saturation` - насыщенность.
- `Darken` - темнее.
- `Brighten` - яркость.

#### `Alpha Mask` - настройка альфа маски

![](..\images\image105.png)

- `Key Color` - цвет вычитаемого цвета.
- `J Weight` - вес яркости.
- `Red Weight` - вес красного цвета.
- `Blue Weight` - вес синего цвета.
- `Inner Mask` - уровень заполнения внутренней маской.
- `Mask Levels` - уровень маски.

#### `Alpha Mask (Advanced)` - продвинутая настройка маски

![](..\images\image67.png)

- `White point` - точка белого
- `Key Type` - тип кеера
- `Border Light` - цвет контура светлее
- `Border Dark` - цвет контура темнее
- `Border Feather` - степень влияния коррекции котуров
- `Floor Level` - уровни маски пола

#### `Inner Mask` - Настройка внутренней маски

![](..\images\image18.png)

- `Red Weight` - вес красного цвета
- `Blue Weight` - вес синего цвета
- `Mask Levels` - уровень маски

#### `Shadows` - Настройка теней

![](..\images\image38.png)

- `Enable` - включение отображения теней
- `Levels` - уровни маски теней
- `DeNoise mix` - уровень шумоподавления в тенях

#### `Highlights` - Настройка отражений и бликов

![](..\images\image157.png)

- `Enable` - включить блики и отражения
- `Blend Mode` - режим наложения
- `Levels` - уровни маски отражений и бликов
- `DeNoise mix` - уровень шумоподавления в отражениях и бликах

#### `Environment` - Настройка наложения освещения от окружения

![](..\images\image180.png)

- `Overlay` - уровень наложения
- `Overlay Blur` - размытие наложения
- `Light Strength` - сила освещения
- `Light Blur` - уровень размытия освещения
- `Light Level` - уровни освещения

#### `Misc` - дополнительный функционал

![](..\images\image110.png)

- `Use BG Alpha` - использовать альфы фона
- `Use BG Stencil` - использовать Stencil фона

### Вкладка `BG`

![](..\images\image164.jpg)

#### `Sharpen` - функция повышения резкости заднего фона

- `Strength` - сила повышения резкости
- `Mix Amount` - количество смешиваний

#### `Lut` - подключение lut файла для цветокоррекции

- `Filename` - нажать на кнопку `...` чтобы указать путь к файлу

#### `Gamma` - коррекция гаммы заднего фона

- `RGB` - гамма красного, зеленого и синего каналов
- `Red` - гамма красного канала
- `Green` - гамма зеленого канала
- `Blue` - гамма синего канала

#### `Curves` - коррекция цвета кривыми

- `Channel` - служит для выбора с какими каналами работает кривая
- `Reset` - сбросить все изменения
- `Smooth` - сгладить кривую

  > Для добавления точки на кривую щелкните <kbd>ЛКМ</kbd> по графику.
  > <br/>Для удаления точки щелкните по ней <kbd>ПКМ</kbd>.

### Вкладка `FG`

![](..\images\image6.jpg)

То же что и Вкладка BG только для переднего плана.

### Вкладка `Mask`

![](..\images\image123.jpg)

#### `Mask Type` - выбор типа маски

- `FBX` - для маски будет использована 3d модель в формате .fbx
- `Texture` - для маски будет использовано изображение

![](..\images\image116.png)

- `Scene` - указывать путь к файлу маски
- `Filename` - нажать на кнопку `...` чтобы указать путь к файлу

- `Objects` - настройка объектов масок
- `ObjType` - тип маски применяемой к объекту:

  ![](..\images\image135.png)

  - `Chromakey BG` - фон хромакейя
  - `Chromakey Floor` - пол хромакейя
  - `VR BG` - виртуальный фон
  - `Excluder` - тип маски для получения изображения реального объекта поверх `VR BG`

- `Texture` - наложение текстуры на объект. Нажать на кнопку `...` чтобы указать путь к файлу

#### `Object offsets` - Настройка положения масок

- `Position` - позиция маски по осям XYZ.
- `Rotation` - угол поворота относительно осей XYZ.
- `Scale` - масштаб объекта относительно осей XYZ.

#### Вкладка управления настройками **Carrot Keyer**:

![](..\images\image2.png)

- `Load` - загрузить ранее сохраненные настройки
- `Save` - сохранить настройки
- `Import` - импортировать **.xml** файл с настройками
- `Export` - сохранить текущие настройки в **.xml** файл
- `Reset` - сбросить настройки с состояние по умолчанию

## Настройка Carrot Launcher

Для настройки **Carrot Launcher** необходимо выполнить следующее:

1. Запустите **Carrot Server** `ServerWS.exe` (Если **Carrot Server** уже запущен, перейдите на пункт 2).
2. Запустите **Carrot Launcher** `LauncherWS.exe`.

> Если **Carrot Server** не был запущен, либо **Carrot Launcher** не смог установить с ним соединение, то на рабочем столе появится окно с ошибкой:
> <br/>![](..\images\image13.png)

При нажатии на кнопку `Отмена` **Carrot Launcher** завершит работу.

При нажатии на кнопку `Повтор` на рабочем столе откроется следующее окно `Settings` с настройками соединения **Carrot Launcher**:

![](..\images\image163.png)

- Вкладка `Assets`
  - `Additional Assets` - путь к директории, в которой хранятся медиа файлы.
  - `Original Assets` - путь к директории, в которой хранятся медиа файлы.
- Вкладка `Delays`
  - `Input Delay` - Задержка видео на входе по умолчанию.
  - `Tracking Delay` - Задержка данных с трекинг системы.
  - `AE Delay` - Задержка АЕ шаблонов.
  - `Keyer Delay` - Задержка трекинг данных от Keyer.
- Вкладка `Network`
  - `Server Host` - Имя или IP адрес хоста сервера.
  - `Silent` - Режим подключения без отображения сообщений об ошибках.
  - `Secure` - Режим защищенного подключения.
  - `Tracking Port` - номер порта для получения трекинг данных.
  - `Raw Data Receiver Port` - номер порта для получения данных формата Raw.
- Вкладка `Processing`
  - `Sync Source` - Источник синхронизации (отдельное устройство или карта захвата)
  - `Watermark Filepath` - путь к файлу для водяного знака.
  - `Video threads count` - количество логических процессоров для обработки видеофайлов.
  - `Dedicated Processing` - обработка видео в выделенных логических процессорах.
  - `Foreground` - Возвращает фокус на Carrot Engine каждые 10 секунд.
  - `Keyer` - тип Keyer'а: `JabKeyer` или `GreenKeyer`.
- Вкладка `Videowall`
  - `Override` - Разворачивает окно Carrot Engine не на полный экран, а на определенные координаты.
  - `X` - Позиция X окна
  - `Y` - Позиция Y окна
  - `Width` - Ширина окна
  - `Height` - Высота окна

После ввода всех необходимых настроек нажмите кнопку `Save` в верхнем правом углу окна и закройте окно `Settings`. **Carrot Launcher** произведет попытку подключения.

При успешном подключении к серверу на рабочем столе появится окно **Carrot Launcher**:

![](..\images\image39.png)

Окно **Carror Launcher** имеет несколько вкладок со следующими опциями:

- Меню `File`

  ![](..\images\image19.png)

  - `Settings` (Горячая клавиша <kbd>F4</kbd>) - открывает окно настройки **Carrot Launcher** (вид и описание окна с его настройками изложены выше).
  - `Exit` (Комбинация клавиш <kbd>Alt + F4</kbd>) - выход из **Carrot Launcher**.

- Меню `Tools`

  ![](..\images\image181.png)

  - `Workstation Registration` - регистрация рабочей станции.

  > Вид и описание окна с его настройками изложены в разделе [Настройка и регистрация рабочей станции](https://carrotsoftware.github.io/docs/#/workflow?id=%d0%9d%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%b8-%d1%80%d0%b5%d0%b3%d0%b8%d1%81%d1%82%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d1%80%d0%b0%d0%b1%d0%be%d1%87%d0%b5%d0%b9-%d1%81%d1%82%d0%b0%d0%bd%d1%86%d0%b8%d0%b8).

- Меню `Help`

  ![](..\images\image93.png)

  - `About` - информация о версии **ПО Carrot**.

## Настройка Carrot System Monitor

Для настройки **Carrot System Monitor** необходимо выполнить следующее:

1. Запустите **Carrot Server** `ServerWS.exe` (Если **Carrot Server** уже запущен, перейдите на пункт 2).
2. Запустите **Carrot System Monitor** `SystemMonitorWS.exe`.

> Если **Carrot Server** не был запущен, либо **Carrot System Monitor** не смог установить с ним соединение, то на рабочем столе появится окно с ошибкой:
> <br/>![](..\images\image13.png)

При нажатии на кнопку `Отмена` **Carrot System Monitor** завершит работу.

При нажатии на кнопку `Повтор` на рабочем столе откроется следующее окно `Settings` с настройками соединения **Carrot System Monitor**:

![](..\images\image22.png)

1. Вкладка `Network`
   - `Server Host` - Имя или IP адрес хоста сервера.
   - `Secure Connection` - Режим защищенного подключения.
2. Вкладка `User`
   - `Auto Logon` - Автоматическая авторизация.
   - `User Name` - Имя пользователя.
   - `Password` - Пароль.

После ввода всех необходимых настроек нажмите кнопку `Save` в верхнем правом углу окна и закройте окно `Settings`. **Carrot System Monitor** произведет попытку подключения.

При успешном подключении к серверу на рабочем столе появится окно **Carrot System Monitor**:

![](..\images\image57.png)

Окно **Carrot System Monitor** имеет несколько вкладок со следующими опциями:

- Меню `File`

  ![](..\images\image8.png)

  - `Settings` (Горячая клавиша <kbd>F4</kbd>) - открывает окно настройки **Carrot System Monitor**
  - `Exit` (Комбинация клавиш <kbd>Alt + F4</kbd>) - выход из **Carrot System Monitor**.

- Меню `Help`

  ![](..\images\image136.png)

  - `About` - информация о версии **ПО Carrot**.

Разделы **Carrot System Monitor**:

| Раздел         | Описание                                                                                                                                                                                         |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `Workstations` | Отображает список всех доступных на указанном сервере рабочих станций и список схем, в которых эти станции задействованы. Есть возможность удалять зарегистрированные рабочие станции с сервера. |
| `Engines`      | Отображает список всех доступных на указанном сервере схем и использованных в них рабочих станций. Есть возможность добавлять, редактировать и удалять схемы.                                    |
| `Users&Groups` | Отображает настройки прав группы пользователей. Есть возможность добавлять, редактировать и удалять их.                                                                                          |
| `Launcher`     | Отображает список всех созданных схем на указанном сервере. Есть возможность запускать, останавливать и производить сброс рабочих станций, указанных в выбранной пользователем схеме.            |

### Раздел `Workstations`

При нажатии на кнопку раздела `Workstations` в **Carrot System Monitor** в окне появляется следующая структура, которая отображает список всех зарегистрированных рабочих станций на указанном сервере и подключенные к ним схемы:

![](..\images\image127.png)

Кнопка `Add Folder` добавляет директорию служит для более удобной организации работы с рабочими станциями.

### Раздел `Engines`

При нажатии на кнопку раздела `Engines` в **Carrot System Monitor** в окне появляется следующая структура, которая отображает список всех доступных схем на указанном сервере и указанные в них рабочие станции:

![](..\images\image128.png)

- Кнопка `Add Folder` добавляет директорию служит для более удобной организации работы со схемами
- Кнопка `Add Engine` позволяет пользователю создать в выбранной папке новую схему. Нажатие на неё открывает в новое окно и предлагает пользователю указать в поле название схемы. После необходимо подтвердить `OK`, либо отменить `Cancel` выбор.
- Кнопка `Edit Scheme` открывает новое окно `Engine Flowchart` для настройки схемы:

  ![](..\images\image31.png)

  Структура окна `Engine Flowchart`:

  - Название выбранной схемы.
  - `Registered inputs` - Указанные у выбранной рабочей станции входы (ноды ввода).
  - `Registered outputs` - Указанные у выбранной рабочей станции выходы (ноды вывода).
  - `Flowchart` - Окно для настройки и сборки нод.
  - `Properties` - Свойства выбранной ноды.
  - `Save` - Сохранение изменений в схеме.

  > Подробное описание и настройка схемы описаны в разделе [Создание схемы работы Carrot Engine](https://carrotsoftware.github.io/docs/#/workflow?id=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d1%85%d0%b5%d0%bc%d1%8b-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b-carrot-engine).

При выборе любой схемы в правой половине окна отображаются свойства выбранного плейлиста:

![](..\images\image128.png)

- `Name` - название схемы.
- `Add Workstation` - позволяет добавить в выбранную схему доступную рабочую станцию `Workstation`.

При нажатии на кнопку `Add Workstation` открывается новое окно для выбора рабочей станции `Workstation` из списка доступных на сервере. При выборе рабочей станции, пользователю предлагается подтвердить выбор с помощью кнопки `OK`.

![](..\images\image131.png)

### Раздел `Users & Groups`

При нажатии на кнопку раздела `Users & Groups` в **Carrot System Monitor** в окне появляется следующая структура, которая отображает список всех доступных групп пользователей, пользователей в них на указанном сервере и указанные для них следующие редактируемые свойства:

- `Name` - Имя группы или пользователя.
- `Role` - Роль группы пользователей.
- `Login` - Логин пользователя (редактируется).
- `Password` - Пароль пользователя.

![](..\images\image65.png)

При нажатии на кнопку `Add Group` открывается новое окно, в котором пользователю предлагается указать название создаваемой группы пользователей. Подтверждение ввода осуществляется при помощи кнопок `OK` (Подтвердить) и `Cancel` (Отмена).

При нажатии на кнопку `Add User` открывается новое окно, в котором пользователю предлагается указать имя нового пользователя. Подтверждение ввода осуществляется при помощи кнопок `OK` (Подтвердить) и `Cancel` (Отмена).

### Раздел `Launcher`

При нажатии на кнопку раздела `Launcher` в **Carrot System Monitor** в окне появляется следующая структура, которая отображает список всех доступных движков `Engines` на указанном сервере и указанные в них рабочие станции `Workstation` и позволяет управлять их работой:

![](..\images\image34.png)

При выборе любой схемы, отображаемые справа связанные со схемой поля с рабочими станциями выделяются цветом, соответствующие их состоянию:

- <span style="color:gray">серый</span>/чёрный - рабочая станция недоступна для запуска.
- <span style="color:yellow; background:gray">желтый</span> - рабочая станция доступна для запуска.
- <span style="color:green">зелёный</span> - рабочая станция запущена.
- <span style="color:blue">синий</span> - рабочая станция выделена пользователем комбинацией клавиш <kbd>Ctrl + ЛКМ</kbd>.

Нажатие на кнопку `Start` запускает все доступные рабочие станции, либо только выделенную пользователем.

Нажатие на кнопку `Stop` останавливает все запущенные рабочие станции, либо только выделенную пользователем.

Нажатие на кнопку `Reset` сбрасывает внутри движка у всех или у определенной пользователем рабочей станции компоненты, имеющие буфер.

## Настройка Carrot Tracking Server

Для настройки **Carrot Tracking Server** необходимо выполнить следующее:

![](..\images\image102.png)

- Меню `File`

  - `Settings` - настройки трекинг сервера.

    ![](..\images\image132.png)

    - `Input COM port` - Входящий COM порт.
    - `Connection Type` - Тип соединения.
    - `Input Port` - Входящий порт для получения данных трекинга.
    - `Output Host` - IP адрес сервера.
    - `Output Port` - Выходной порт для отправки трекинг данных на **Carrot Engine**.
    - `Output Broadcast` - для трансляции трекинг данных по всей локальной сети.

  - `Import settings` - Импорт Настроек.
  - `Export settings` - Экспорт Настроек.
  - `Export settings (Tracking Snapshot)` - Экспорт Настроек без Oversize.
  - `Exit` - Выход.

- Панель сетевых настроек:

  ![](..\images\image142.png)

  - `Provider` - Выбор протокола с трекинг данными.
  - `Port` - Входящий порт для получения данных трекинга.
  - `Output Host` - IP адрес сервера.
  - `Output Port` - Выходной порт для отправки трекинг данных на **Carrot Engine**.
  - `Delay` - Задержка в милисекундах.

- Блоки `position` & `rotation`

  ![](..\images\image92.png)

  - Первый блок для управления системами координат.
  - Блок `Offset` - для задания Offset на входящие координаты.
  - Блок `Scale` - для масштабирования входящих координат.
  - Блок `Override` - для замены входящий координаты вписанной в данное меню.

- Блок `Raw Lens Data` - для работы с данными приходящий от линзы:

  ![](..\images\image49.png)

  - `Set min` / `Set max` - для задания рабочих отрезков по данным.
  - `Override` - для задания своих числовых значений.

- Блок `Lens File`:

  - `Lens` путь к файлу линзы созданного в **Carrot Lens calibrator**.
  - `Focus` путь к файлу линзы и информацией DOF.

- Блок `Calibrated Lens`:

  - Информация о искажениях линзы идущих с трекинг системы.
  - `Override` - для задания своих числовых значений.

- Блок `Input` - отображает данные которые присылает трекинг система.
  ![](..\images\image71.png)

## Настройка Carrot AE Plugin

Для настройки **Carrot AE Plugin** необходимо выполнить следующее:

1.  Запустите **Carrot Server** `ServerWS.exe` (Если **Carrot Server** уже запущен, перейдите на пункт 2).
2.  Убедитесь в том, что в настройках **Carrot Template Preview** в настройках указан адрес необходимого сервера и номер порта для получения трекинг данных.
3.  Установите плагин **Carrot AE Export** для **AE**. Для установки содержимое папки необходимо переместить в папку по следующему пути:
    `C:\Program Files\Adobe\Common\Plug-ins\7.0\MediaCore\AEGP`

        ![](..\images\image48.png)

4.  Плагин готов к работе. Процесс экспорта шаблона из **AE** подробно описан в пункте [Экспорт шаблона из проекта АЕ](https://carrotsoftware.github.io/docs/#/workflow?id=%d0%ad%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0-%d0%b8%d0%b7-%d0%bf%d1%80%d0%be%d0%b5%d0%ba%d1%82%d0%b0-ae).

## Настройка Carrot UE4 Plugin

Для настройки **Carrot UE4 Plugin** необходимо выполнить следующее:

1. В программе **UE4** открыть окно настройки `Plugins`

   ![](..\images\image115.jpg)

2. В общем списке выбрать `Carrot` и `CarrotEditor`

   ![](..\images\image10.png)

3. Перезапустить проект **UE**.
