# Carrot Server

В данном разделе можно ознакомиться с назначением, приципом работы и взаимодействием с Carrot Server.

---

## Назначение 

**Carrot Server** предназначен для обеспечения взаимодействия между модулями Carrot, хранения медия и базы данных.

>*В случае, если **Carrot Server** не запущен, то корректное функционирование других приложений - **невозможно**.*

---

## Функциональные возможности

К функциональным возможностям программного модуля **Carrot Server** относится:
- хранение медиа и базы данных;
- обеспечение взаимодействия между приложениями Carrot;
- формирование списка подключений.

---

## Общие сведения

Интерфейс программного модуля **Carrot Server** состоит из следующих элементов:
1. File;
2. Tools;
3. Help;
4. Основное рабочее пространство;
5. Статус бар.

### **1. Элемент "File"**

Элемент **File** cодержит следующие кнопки:

|Наименование кнопки|Назначение|
|-------------------|----------|
|`Settings`|Настройка параметров Carrot Server.|
|`Exit`|Завершение работы Carrot Server.|
|||

**1.1. Окно Settings**

Окно **Settings** содержит следующие разделы:
- Common;
- Data Base;
- Digital Assets;
- GPIO;
- III Protocol Commands;
- License;
- Miscellaneous;
- Replication;
- Resource Manager;
- Statistics;
- WebSocket.

**1.1.1. Раздел Common**

Раздел **Common** содержит единственный настраиваемый параметр - **Server Name**. 

|Наименование параметра|Назначение|
|-------------------|----------|
|`Server Name`|Присвоение персонального имени рабочей станции, на которой запущен **Carrot Server**. Целью данного параметра является определение имени рабочей станции в случае, если произошла нештатная ситуация (прекращение работы, некорректная работа и т.п.).| 

>Имя рабочей станции непосредственно задействуется в модуле **System Monitor**.

---

**1.1.2. Раздел Data Base**

Раздел **Data Base** содержит следующие настраиваемые параметры:

|Наименование параметра|Назначение|
|-------------------|----------|
|`Directory`|Указание Carrot Server директории (пути) к базе данных.|

>В **базе данных** содержится основная вся информация (AE шаблоны, .xml и .xlsx файлы и пр.), необходимая для работы всего **ПО Carrot**.
>
>Рекомендуется всегда указывать стандартную директорию (путь) к данной директории, а именно: C:\Users\ИМЯ_КОМПЬЮТЕРА\AppData\Local\Carrot\DB\

|||
|-------------------|----------|
|`Backup Directory`|Указание Carrot Server директории (пути) к резервной копии базы данных.|

>Рекомендуется всегда указывать стандартную директорию (путь) к данной директории, а именно: C:\Users\ИМЯ_КОМПЬЮТЕРА\AppData\Local\Carrot\backups\

|||
|-------------------|----------|
|`Unique Event names`|Использование индивидуальных имён эвентов в базе данных.|
|`Windows Restricted Chars`|Проверка имён шаблонов на наличие специальных симоволов V:*'?<>| |
|`Skylark Integration`|Включение синхронизации со **Skylark**.|


>**Skylark** представляет из себя сторонний программный комплекс, осуществляющий автоматическое транслирование "медиа" при взаимодействии с **ПО Carrot**.

|||
|-------------------|----------|
|`Check Authorization And Roles`|Проверка авторизированного пользователя на предмет доступных ему функциональных возможностей|
|`Check user channels`|Разграничение уровня доступа пользователей к объектам базы данных.|
||| 

**1.1.3. Раздел Digital Assets**

Раздел **Digital Assets** содержит следующие настраиваемые параметры:

|Наименование параметра|Назначение|
|-------------------|----------|
|`Directory`|Указание Carrot Server директории (пути) к базе данных.|

>Рекомендуется не изменять изначальную директорию (путь), а именно:
C:\Users\ИМЯ_КОМПЬЮТЕРА\AppData\Local\Carrot\Library\

|||
|-------------------|----------|
|`Copy Assets`|Копирование ассетов.|
||| 

**1.1.4. Раздел GPIO**

Раздел **GPIO** содержит единственный настраиваемый параметр - **Keep UE Event Active Status**. 

|Наименование параметра|Назначение|
|-------------------|----------|
|`Keep UE Event Active Status`|Вызов одного и того же стейта при воспроизведения события из плейлиста.| 
||| 

**1.1.5. Раздел III Protocol Commands**

Раздел **GPIO** содержит единственный настраиваемый параметр - **Use STOP**. 

|Наименование параметра|Назначение|
|-------------------|----------|
|`Use STOP`|Включение использования протокола III, позволяющего игнорировать команду STOP, взамодействую только с компандой PLAY.|

>Данный параметр необходим, в случае, если мы хотим использовать разный функционал взаимодействия и воспроизведения плэйлиста из внешних источников.

---

**1.1.6. Раздел License**

Раздел **License** содержит единственный настраиваемый параметр - **License Key**. 

|Наименование параметра|Назначение|
|-------------------|----------|
|`License Key`|Ввод лицензионного ключа Carrot.|

>Лицензионный ключ необходим для доступа ко всему функционалу работы **ПО Carrot**. Без лицензионного ключа, функционал работы будет ограничен.

---

**1.1.7. Раздел Miscellaneous**

Раздел **License** содержит единственный настраиваемый параметр - **Hide to Tray**. 

|Наименование параметра|Назначение|
|-------------------|----------|
|`Hide to Tray`||
||| 

**1.1.7. Раздел Replication**

Раздел **Replication** содержит следующие настраеваемые параметры:

|Наименование параметра|Назначение|
|-------------------|----------|
|`Replication Hosts`|Указание IP-адреса резервного сервера с которым синхронизируется база данных **Carrot Server**.|

>В **Replication Hosts** возможна запись нескольких IP-адресов резервных серверов, запись которых осуществляется через запятую в следующем формате: 192.168.1.1, 192.168.1.2, 192.168.1.3.

|||
|-------------------|----------|
|`DB Autoreplication on Start`|Автоматическая синхронизации базы данных **Carrot Server** при его запуске.|
|`Local IP for Replication`|Указание локального IP-адреса в котором, синхронизируются данные.|
||| 

**1.1.8. Раздел Resource Manager**

Раздел **Resource Manager** содержит следующие настраеваемые параметры:

|Наименование параметра|Назначение|
|-------------------|----------|
|`Use Preloading`|Использование предварительно загруженных эвентов.|
|`Preload Count`|Указание количества предварительно загружаемых эвентов после воспроизведения текущего в Playlist'e.|

>Параметр **Preload Count** всегда должен быть больше "0"

|||
|-------------------|----------|
|`MOS Preload`|Включение автоматической предварительной загрузки эвентов используемых в MOS.|
|||

**1.1.9. Раздел Statiscs**

Раздел **Statiscs** содержит единственный настраиваемый параметр - **Collect Statistic**. 

|Наименование параметра|Назначение|
|-------------------|----------|
|`Collect Statistic`|Включение сбора статистических данных.|

**1.1.10. Раздел WebSocket**

Раздел **WebSocket** содержит следующие настраиваемые параметры:

|Наименование параметра|Назначение|
|-------------------|----------|
|`Certificate`|Указание директории (пути) к сертификату шифрования.|

>Сертификат необходим для установления соединения защищённым шифрованием. Сертификат представляет из себя файл формата ".pfx".

|||
|-------------------|----------|
|`Certificate Password`|Ввод пароля для сертификата.|
|`Secure Connection`|Выбор соединения - защищённое шифрование / незащищённое.|
|||

### **2. Элемент "Tools"**

Элемент **Tools** cодержит следующие функциональные кнопки:

|Наименование функциональной кнопки|Назначение|
|-------------------|----------|
|`Change Administrator Password`|Смена пароля администратора.|
|`Reset Event Status`|Обновление поля компонентов для корректного отображения активных приложений.|
|`Set Server As Master`|Определение текущего **Carrot Server** в качестве "Мастера" (основного).|

>"Мастер" сервер отображается в поле статуса как Replication Index = 0.
>
>При использовании нескольких серверов с реплицируемой (синхронизируемой) базой данных с индексом отличающимся от "0" необходимо знать, что все остальные сервера определяются как резервные.
>
>При отсутствии репликации (синхронизации) между серверами у всех будет присвоен индекс "0"! 

|||
|-------------------|----------|
|`Replicate Database`|Репликация (синхронизация) базы данных **Carrot Server**.|
|`Export DB file`|Экспорт базы данных **Carrot Server**.|
|`Export DB objects`|Экспорт объектов базы данных **Carrot Server**.|
|`Import DB file`|Импорт базы данных **Carrot Server**.|
|`Import DB objects`|Импорт объектов базы данных **Carrot Server**.|
|`Web`||
|`DataStream`||
|`Update DB to current Version`|Обновление базы данных до текущей версии **Carrot**.|
|`Remove Inaccessible DB Objects`|Удаление недоступных объектов базы данных.|
|||

### **3. Элемент "Help"**

Элемент **Help** содержит функциональное окно **About** отображающее сведения о текущей версии сборки **ПО Carrot**.

### **4. Элемент "Основное рабочее пространство"**

Интерфейс основного рабочего пространства включает в себя:
- кнопку **Disconect Selected**. Предназначена для удаления выбранных подключений из списка;
- кнопку **Refresh**. Предназначенную для обновления списка подключений. Используется для тех случаев, когда известно, что подключение существует, но оно не отображается в списке.

>Функционал кнопки **Refresh** реализован через цикл непрерывного обновления списка. В случае отображения всех подключений в списке, необходимо прервать обновление, для этого следует повторно нажать на кнопку **Refresh**.

- IP-адрес. Предназначен для отображения числового идентификатора подключаемого устройства;
- App. Предназначен для отображения имени подключенного (функционирующего) приложения;

>Дополнительно, после имени приложения, в круглых скобках может указываться способ определения приложения как "Master", что информирует о том что оно является "Основным" и поддерживает резервирования. В остальных случаях, приложение является "Резервным".

- Object. Предназначен для отображения имени объекта, с которым работает подключенное (функционирующее) приложение.

### **5. Элемент Статус-бар**

**Статус-бар** предназначен для отображения информационных сведений, а именно:
- Тип определения сервера (Основной или резервный), определяемый параметром **Replication Index**;

>Следует помнить, что "основной" сервер отображается с индексом "0".

- Статус репликации (синхронизации) базы данных, определяемый параметром **DB Replication Progress = 0/0**.

---
