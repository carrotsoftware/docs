# Carrot Server

## Назначение программного модуля

***Carrot Server*** - представляет из себя серверное приложение, предназначенное для обеспечения взаимодействия программных модулей ПО Carrot, а также для хранения мультимедийного контента и формирования базы данных.

>***ВАЖНО!*** 
>
>*В случае, если **Carrot Server** не запущен, то корректное функционирование других программных модулей - **невозможно**.*

## Функциональные возможности программного модуля

К функциональным возможностям программного модуля ***Carrot Server*** относится:
* хранение мультимедийного контента;
* формирование базы данных;
* обеспечение взаимодействия между программными модулями;
* ведение списка подключений.

## Общие сведения о программном модуле

Интерфейс программного модуля **Carrot Server** состоит из следующих элементов:
1. File;
2. Tools;
3. Help;
4. Основное рабочее пространство;
5. Статус бар.

### **1. Элемент File**

Элемент File cодержит следующие функциональные окна:
* Settings. Предназначено для настройки необходимых параметров Carrot Server;
* Exit. Предназначено для завершения работы Carrot Server.

**1.1. Окно Settings**

Окно **Settings** содержит следующие разделы:
* Common;
* Data Base;
* Digital Assets;
* GPIO;
* III Protocol Commands;
* License;
* Miscellaneous;
* Replication;
* Resource Manager;
* Statistics;
* WebSocket.

**1.1.1. Раздел Common**

Раздел **Common** содержит единственный настраиваемый параметр - **Server Name**. 

Параметр **Server Name** предназначен для присвоения персонального имени серверу на котором запущен **Carrot Server**. Целью данного параметра является определение наименования сервера пользователем в случае, если произошла нештатная ситуация (прекращение работы, некорректная работа и т.п.). 

>***ВАЖНО!*** 
>
>*Имя сервера непосредственно задействуется в **System Monitor***.

**1.1.2. Раздел Data Base**

Раздел **Data Base** содержит следующие настраеваемые параметры:

* Directory - предназначен для указания Carrot Server директории (пути) к базе данных;

>***ВАЖНО!*** 
>
>*В **базе данных** содержится основная вся информация (AE шаблоны, xml и xlsx файлы и пр.), необходимая для работы всего **ПО Carrot***.
>
>Рекомендуется всегда указывать стандартную директорию (путь) к данной директории, а именно: C:\Users\"ИМЯ_КОМПЬЮТЕРА"\AppData\Local\Carrot\DB\

* Backup Directory - предназначен для указания Carrot Server директории (пути) к резервной копии базы данных;

>***ВАЖНО!*** 
>
>Рекомендуется всегда указывать стандартную директорию (путь) к данной директории, а именно: C:\Users\"ИМЯ_КОМПЬЮТЕРА"\AppData\Local\Carrot\backups\

* Unique Event names - предназначен для использования индивидуальных имён эвентов в базе данных;

* Windows Restricted Chars - предназначен для проверки имён шаблонов на наличие специальных симоволов **V:*'?<>|** ;

* Skylark Integration - предназначен для осуществления синхронизации со **Skylark**;

>***ВАЖНО!*** 
>
>**Skylark** представляет из себя сторонний программный комплекс, осуществляющий автоматическое транслирование "медиа" при взаимодействии с **ПО Carrot**.

* Check Authorization And Roles - предназначен для проверки авторизированного пользователя на предмет доступных ему функциональных возможностей;

* Check user channels - предназначен для ограничения доступа к объектам базы данных другим пользователям;


**1.1.3. Раздел Digital Assets**

Раздел **Digital Assets** содержит следующие настраеваемые параметры:

* Directory - предназначен для указания Carrot Server директории (пути) к воспроизводимым "медиа" (AE шаблоны и пр.).

>***ВАЖНО!*** 
>
>Рекомендуется не изменять изначальную директорию (путь), а именно:
C:\Users\"ИМЯ_КОМПЬЮТЕРА"\AppData\Local\Carrot\Library\

* Copy Assets - предназначен для копирования ассетов

**1.1.4. Раздел GPIO**

Раздел **GPIO** содержит единственный настраиваемый параметр - **Keep UE Event Active Status**. 

Параметр **Keep UE Event Active Status** предназначен для вызова одного и того же стейта при воспроизведения события из плейлиста. 


**1.1.5. Раздел III Protocol Commands**

Раздел **GPIO** содержит единственный настраиваемый параметр - **Use STOP**. 

Параметр **Use STOP** предназначен для использования протокола III, позволяющего игнорировать команду STOP, взамодействую только с компандой PLAY.

>***ВАЖНО!*** 
>
>Данный параметр необходим, в случае, если мы хотим использовать разный функционал взаимодействия и воспроизведения плэйлиста из внешних источников.

**1.1.6. Раздел License**

Раздел **License** содержит единственный настраиваемый параметр - **License Key**. 

Параметр **License Key** предназначен для внесения лицензионного ключа Carrot.

>***ВАЖНО!*** 
>
>Лицензионный ключ необходим для доступа ко всему функционалу работы **ПО Carrot**. Без лицензионного ключа, функционал работы будет ограничен.


**1.1.7. Раздел Miscellaneous**

Раздел **License** содержит единственный настраиваемый параметр - **Hide to Tray**. 

Параметр **Hide to Tray** предназначен для.

**1.1.7. Раздел Replication**

Раздел **Replication** содержит следующие настраеваемые параметры:

* Replication Hosts - предназначен для указания IP-адреса резервного сервера с которым синхронизируется база данных **Carrot Server**.

>***ВАЖНО!*** 
>
>В **Replication Hosts** возможна запись нескольких IP-адресов резервных серверов, запись которых осуществляется через запятую в следующем формате: 192.168.1.1, 192.168.1.2, 192.168.1.3.

* DB Autoreplication on Start - предназначен для автоматической синхронизации базы данных **Carrot Server** при его запуске.
* Local IP for Replication - предназначен для указания локального IP-адреса в котором, синхронизируются данные.

**1.1.8. Раздел Resource Manager**

Раздел **Resource Manager** содержит следующие настраеваемые параметры:

* Use Preloading - предназначен для использования предварительно загруженных эвентов;
* Preload Count - предназначен для указания количества предварительно загружаемых эвентов после воспроизведения текущего в Playlist'e;

>***ВАЖНО!*** 
>
>Параметр **Preload Count** всегда должен быть больше "0"

* MOS Preload - предназначен для автоматической предварительной загрузки эвентов используемых в MOS.

**1.1.9. Раздел Statiscs**

Раздел **Statiscs** содержит единственный настраиваемый параметр - **Collect Statistic**. 

Параметр **Collect Statistic** - предназначен для сбора статистических данных.

**1.1.10. Раздел WebSocket**

Раздел **WebSocket** содержит следующие настраеваемые параметры:

* Certificate - предназначен для указания директории (пути) к сертификату шифрования;

>***ВАЖНО!*** 
>
>Сертификат необходим для установления соединения защищённым шифрованием.
>Сертификат представляет из себя файл формата ".pfx".

* Certificate Password - предназначен для ввода пароля для сертификата;
* Secure Connection - предназначен для выбора соединения - защищённое шифрование / незащищённое.

### **2. Элемент Tools**

Элемент **Tools** cодержит следующие функциональные кнопки:
* Change Administrator Password. Предназначен для смены пароля администратора;
* Reset Event Status. Предназначен для обновления поля компонентов для корректного отображения активных приложений;
* Set Server As Master. Предназначен для определения текущего **Carrot Server** в качестве "основного";

>***ВАЖНО!*** 
>
>"Основной" сервер отображается в поле статуса как Replication Index = 0.
>
>При использовании нескольких серверов с реплицируемой (синхронизируемой) базой данных с индексом отличающимся от "0" необходимо знать, что все остальные сервера являются резервными.
>
>При отсутствии репликации (синхронизации) между серверами у всех будет присвоен индекс "0"! 

* Replicate Database. Предназначен для репликации (синхронизации) базы данных **Carrot Server**;
* Export DB file. Предназначен для экспорта базы данных **Carrot Server**;
* Export DB objects. Предназначен для экспорта объектов базы данных **Carrot Server**;
* Import DB file. Предназначен для импорта базы данных **Carrot Server**;
* Import DB objects. Предназначен для импорта объектов базы данных **Carrot Server**;
* Web. ;
* DataStream. ;
* Update DB to current Version. Предназначен для обновления базы данных до текущей версии **Carrot**;
* Remove Inaccessible DB Objects. Предназначен для удаления недоступных объектов базы данных.

### **3. Элемент Help**

Элемент **Help** содержит функциональное окно **About** отображающее сведения о текущей версии сборки **ПО Carrot**

### **4. Элемент Основное рабочее пространство**

Интерфейс основного рабочего пространства включает в себя:
* Кнопку **Disconect Selected**. Предназначена для удаления выбранных подключений из списка;
* Кнопку **Refresh**. Предназначенную для обновления списка подключений. Используется для тех случаев, когда известно, что подключение существует, но оно не отображается в списке.

>***ВАЖНО!*** 
>
>Функционал кнопки **Refresh** реализован через цикл непрерывного обновления списка. В случае отображения всех подключений в списке, необходимо прервать обновление, для этого следует повторно нажать на кнопку **Refresh**.

* IP-адрес. Предназначен для отображения числового идентификатора подключаемого устройства;
* App. Предназначен для отображения имени подключенного (функционирующего) приложения;

>***ВАЖНО!*** 
>
>Дополнительно, после имени приложения, в круглых скобках может указываться способ определения приложения как "Master", что информирует о том что оно является "Основным" и поддерживает резервирования. В остальных случаях, приложение является "Резервным".

* Object. Предназначен для отображения имени объекта, с которым работает подключенное (функционирующее) приложение.

### **5. Элемент Статус-бар**

**Статус-бар** предназначен для отображения информационных сведений, а именно:
* Тип определения сервера (Основной или резервный), определяемый параметром **Replication Index**;

>***ВАЖНО!*** 
>
>Следует помнить, что "основной" сервер отображается с индексом "0".

* Статус репликации (синхронизации) базы данных, определяемый параметром **DB Replication Progress = 0/0**.