# Список изменений rev. 3258 => rev. 3998

## Общие изменения
- добавлена поддержка обработки видео с помощью `CUDA` (*для кодека `h265`*);
- ускорена передача ассетов между компонентами **Carrot** по сети;
- добавлена утилита **LensCalibrator**;
- добавлено использование ключей лицензии;
- если лицензии нет, будет отображаться водяной знак;
- добавление ярлыков на рабочий стол при вызове `InitSettings`.

## Carrot Server
- функционал добавления ассетов, содержащих только путь к файлу;
- `Import`/`Export` для файла **БД** в **Carrot Server**;
- добавлен параметр `CheckNameForRestrictedChars` (проверяет имя шаблона и папки с шаблонами на наличие символов `\/:*\"?<>|` - необходимо для возможности сохранять структуру **БД** в **Windows**-папку);
- добавлен параметр `UseUniqueTemplateNames` (*использует уникальное имя шаблона для всей БД*);
- добавлено логирование на стороне **CarrotServer** и на стороне **CarrotEngine**;
- в **CarrotServer** добавлена настройка `CheckAuthorizationAndRoles` - включает\отключает проверку авторизации и доступ к функционалу по ролям;
- репликация возможна как по **IP** так и по имени машины.

## Carrot Launcher
- добавлена возможность интерполяции приходящих трекинг данных `Use Delta MS`;
- улучшена работа в режиме `i`;
- добавлено проходное **Audio** для **AJA**;
- добавлен захват **Audio** с **Windows** для **AJA**;
- добавлена возможность принимать сигнал `p50`, а отдавать `i50` при работе с **BMD**;
- в `BmdFillKey` добавлен параметр `ExternalKey` - если он `True`, то сигнал по соску `Key` выдаваться не будет;
- добавлена поддержка проходного аудио для **BMD** (*приём на `BmdInput`, отдача на `BmdOutput` с учётом выставленных задержек) (поддерживается до 16 каналов (на 8kPro и Duo2)*);
- максимальное число устройств в `BmdOutput` увеличено до **8**.


## Carrot WebPlaylist
- добавлены специальные эвенты: `Reset`, `StopPlaylist`, `Text Command` (*применение настроек кеера*);
- добавлена настройка, отвечающая за показ превью;
- при удалении контейнера, у привязанных шаблонов и эвентов выставляется `NoContent`. У эвентов выставляется статус `Unload`;
- добавлена настройка **WebPlaylist**, позволяющая не передавать файл по вебсокетам, если CarrotServer расположен на той же машине;
- добавлен выбор `Default` значения для переменной эвента;
- в **Preview Engine** добавлена настройка `Picture Fit` - характер отображения картинки;
- добавлена текстовая команда (*специальный эвент `Text Command`*) для рестарта тикера из плейлиста;
- в веб-плейлисте разделе `Editor` в регионе `Properties` добавлена кнопка `Save As New`. Суть: *при редактировании эвента кнопка `Save As New` позволяет создать его копию с параметрами, которые были изменены, но еще не сохранены (не была нажата кнопка `Save`). При этом оригинал не изменяется. Копия встаёт рядом с оригиналом (под ним)*;
- добавлена текстовая команда (*специальный эвент `Text Command`*) `TakeOutContainer`;
- добавлена возможность поставить текстуру на задний фон для `CarrotPreviewEngine`;
- добавлена возможность работать в нескольких открытых вкладках веб-плейлиста, либо работать под одной учетной записью на разных серверах;
- добавлена текстовая команда (*специальный эвент `Text Command`*) `SetGlobalVar` - для возможности изменять глобальные переменные из плейлиста;
- добавлена обработка множественных команд в специальном эвенте `TextCommand`;
- вынесены в настройки `WebPlaylistServer` отображение/скрытие стейтов события, когда их два;
- добавлен функционал по переименованию события содержимым текстовой переменной, если в событии всего одна переменная;
- в веб-плелисте во вкладке `Playlist` отображается не только имя, но и путь до плейлиста;
- добавлена возможность сортировки объектов по дате создания.

## Carrot System Monitor
- добавлены ноды `Blur` и `Distortion` в схеме движка;
- `Width` и `Height` для `AR`, `Keyer`, `Luma` задаются из настроек схемы (*до этого было всегда 1920Х1080*);
- добавлена нода `Resize` в схеме движка;
- добавлена нода `Undistort` в схеме движка;
- добавлена нода `Ticker` в схеме движка;
- Добавлена нода `Image Tracker` в схеме движка;
- добавлен доступ к функционалу по ролям группы учетных записей (*`SystemEdit`,  `PlaylistEdit`, `TemplateEdit`, `SystemView`, `PlaylistView`, `TemplateView`, `GlobalVarEdit`*).

## Carrot Engine
- во вкладке `Tools` добавлены кнопки `PauseVideo` и `ResetVideo` для **FBX**-шаблонов;
- добавлена работа с **GPIO**;
- добавлена работа с **MIDI**;
- добавлен новый тип объектов в кеере - `Stencil Mask`;
- в кеер добавлены настройки `DespillAffect` и `AlphaAffect`;
- исправлено падение **Carrot Engine** при отсутствии трекинга;
- улучшена работа `LUT Utils`;
- добавлена возможность отображения "заглушки";
- теперь несколько команд, отправленных в **UE** за один кадр, будут исполняться последовательно по одному кадру на команду. Ранее не все команды доходили до **UE** при множественном вызове нескольких команд;
- для кеера добавлен параметр включенияя сглаживания `FXAA`;
- добавлено сохранение трансформаций объектов **FBX** шаблона;
- добавлена возможность выполнять скрипты и выражения **AE** в параллельном потоке (*снижается нагрузка на ЦП, но не гарантируется исполнение в текущем кадре*);
- добавлена синхронная выдача изображения не несколько сосков (*за счёт использования параметра `GroupID`*);
- добавлена поддержка `CarrotMacroControl`.

## Работа с AE шаблонами
- добавлен `Remote Link` для **FBX** шаблонов;
- исправлен метод `Renew` в **TemplatePreview**;
- добавлена поддержка эффекта `FastBoxBlur`;
- поддержка `SysTime` в `AE expressions`;
- добавлен режим `Simultaneous` для проигрывания стейта шаблона;
- если в эвенте на `IN` выбран закрывающий стейт, то сразу вызовется `Take Out`;
- добавлена подержка эффекта `CornerPin`;
- добавлена подержка эффекта `Posterize Time`;
- если у эвента есть длительность (*задаётся системой автоматизации*), то у шаблона сработает `OUT` таким образом, чтобы завершение анимации `OUT` совпало с окончанием длительности стейта;
- добавлен контроль `ComboBox` - выбор из готовых значений + возможность ввести значение вручную;
- в скрипты добавлен новый параметр `TextSource` - возвращает объект `ValueText`, содержащий в себе информацию о текстовом объекте;
- добавлено ограничение ввода текста по количеству символов (*настройка делается из `Template Preview`*).

## Работа с UE шаблонами
- добавлена возможность передать промежуточный результат кеера (`FG` с альфой) в **UE**;
- при экспорте **UE** шаблона в **Carrot** в настройках переменных можно выбирать стейт шаблона;
- добавлена поддержа **UE5**;
- добавлена опция `Renew` для **UE** шаблонов;
- добавлен `Overlap Index` для стейта шаблона.

## Работа с DataStream
- добавлено отображение ошибок при работе плагинов **DataStream**;
- добавлен `XLSXParser` для **DataStream**;
- адаптирован плагин `XLSXParser` для работы с `Ticker`.